(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4502"],{"6Oo8":function(e,t,i){},PwfK:function(e,t,i){"use strict";i.r(t);var s=i("Mz3J"),n=i("aFx9"),a=i("wk8/"),l=i("sxGJ"),o=i.n(l),c={components:{Pagination:s.a},data:function(){return{imgLists:[],checkAll:!1,isIndeterminate:!0,checkedImages:[],listQuery:{page:1,limit:18,type:0,sort:"+id"},total:0,mainLoading:!1,options:[],selectValue:"",firstOption:{id:0,name:"全部"},selectImages:[],imagesBackup:[],isExist:!0,imageInfoDialog:!1,imageLinkDialog:!1,imgInfo:[],linksArea:"",linksRows:0,linksBackup:"",fullScreen:!1,dialogLink:"",imageDialog:!1,singleInfo:!1,info:[],syncImageInfo:[],ws:null,wsMsg:"",progress:0,showProgress:!1,user:"",uid:0,showUser:!1,model:"edit"}},created:function(){this.getStore(),this.getList()},methods:{deleteImg:function(e,t){var i=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.a)([t,0]),i.imgLists.splice(e,1),i.$message({type:"success",message:"删除成功!"})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},zoom:function(e){this.dialogLink="",this.dialogLink=e,this.imageDialog=!0},jump:function(e){window.open(e)},handleCheckAllChange:function(e){this.checkedImages=e?this.imgLists:[],this.isIndeterminate=!1},handleCheckedImageChange:function(e){var t=e.length;this.checkAll=t===this.imgLists.length,this.isIndeterminate=t>0&&t<this.imgLists.length},deleteChecked:function(){var e=this;0===this.checkedImages.length?this.$message({type:"warning",message:"您没有选择任何图片"}):this.$confirm("此操作将永久删除记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=[],i=e.checkedImages.length,s=0;s<i;s++)console.log(e.checkedImages[s].id),t[s]=e.checkedImages[s].id;Object(n.a)(t);var a=[];e.imgLists.forEach(function(t){var i=e.checkedImages.findIndex(function(e){return t===e});i>-1?delete e.checkedImages[i]:a.push(t)}),e.imgLists=a,e.$message({type:"success",message:"删除成功!"}),e.checkedImages=[]}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},getList:function(){var e=this;this.mainLoading=!0,this.uid=this.$route.params.id,this.uid&&(this.showUser=!0),this.showUser?Object(a.c)(this.uid,this.listQuery).then(function(t){e.imgLists=t.list,e.imagesBackup=t.list,e.total=t.total,e.mainLoading=!1,void 0!==e.imgLists&&0!==e.imgLists.length?(e.isExist=!0,e.user=t.list[0].user.username,console.log(t.list[0].user.username)):e.isExist=!1}):Object(n.c)(this.listQuery).then(function(t){e.imgLists=t.list,e.imagesBackup=t.list,e.total=t.total,e.mainLoading=!1,void 0!==e.imgLists&&0!==e.imgLists.length?e.isExist=!0:e.isExist=!1}),this.checkedImages=[],this.checkAll=!1},getAll:function(){console.log(this.checkedImages)},getStore:function(){var e=this;Object(n.d)().then(function(t){e.options=t.list,e.options.unshift(e.firstOption)})},getSelectImages:function(e){this.listQuery.type=e,this.imgLists=this.getList()},showInfo:function(){0!==this.checkedImages.length&&void 0!==this.checkedImages?(this.imgInfo=this.checkedImages,this.imageInfoDialog=!0):this.$message({type:"warning",message:"没有选中任何图片"})},getCheckedImageLinks:function(){var e=this;0!==this.checkedImages.length&&void 0!==this.checkedImages?(this.linksRows=0,this.linksBackup="",this.linksArea="",this.fullScreen=!1,this.checkedImages.forEach(function(t){e.linksArea+=t.link+"\n",e.linksRows++}),this.linksRows>10&&(this.fullScreen=!0),this.linksBackup=this.linksArea,this.imageLinkDialog=!0):this.$message({type:"warning",message:"您没有选择任何图片"})},copy:function(){var e=this,t=new o.a(".tag-read");console.log(t),t.on("success",function(i){e.$message({type:"success",message:"复制成功"}),t.destroy()}),t.on("error",function(e){console.log("该浏览器不支持自动复制"),t.destroy()})},transformTo:function(e,t){var i=this;switch(this.linksArea="",e.label){case"URL":this.linksArea=this.linksBackup;break;case"MarkDown":this.checkedImages.forEach(function(e){i.linksArea+="!["+e.name+"]("+e.link+")\n"});break;case"HTML":this.checkedImages.forEach(function(e){i.linksArea+='<img  alt="'+e.name+'" src="'+e.link+'" />\n'});break;case"BBCode":this.checkedImages.forEach(function(e){i.linksArea+="[img]"+e.link+"[/img]\n"})}console.log(this.linksRows)},showSingleInfo:function(e){this.info=e,this.singleInfo=!0},syncToLocal:function(){var e=this;if(0!==this.checkedImages.length&&void 0!==this.checkedImages){this.ws=new WebSocket(Object({NODE_ENV:"production",BASE_API:"/api/v1"}).WS_LOCATION),this.syncImageInfo=[];var t=this.checkedImages.length;this.checkedImages.forEach(function(t,i){e.syncImageInfo[i]={id:t.id,url:t.link}});var i=this;this.showProgress=!0,this.ws.addEventListener("message",function(e){var s=JSON.parse(e.data);switch(console.log("进入监听"),s.status){case"running":i.progress=(s.data+1)/t*100,console.log(i.progress);break;case"success":console.log("同步完成"),i.$notify({title:s.title,message:s.msg,type:s.status}),i.showProgress=!1;break;case"timeout":console.log("任务超时"),i.$notify({title:s.title,message:s.msg,type:"danger"}),i.ws.close()}}),Object(n.f)(this.syncImageInfo)}else this.$message({type:"warning",message:"没有选中任何图片"})},notification:function(e){this.$notify({title:"同步成功",message:e,type:"success"})},changeModel:function(){var e=this;setTimeout(function(){e.$router.push({name:"usersInfoView",params:{id:e.uid}})},100)}}},r=(i("Z8mc"),i("KHd+")),u=Object(r.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",[i("el-main",[i("el-row",{staticStyle:{"margin-left":"22px",padding:"6px 0px 6px 18px"}},[i("el-checkbox-group",{attrs:{indeterminate:e.isIndeterminate,size:"mini"},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[i("el-checkbox",{attrs:{label:"全选",border:""}}),e._v(" "),i("el-select",{staticStyle:{"margin-left":"40px"},attrs:{placeholder:"选择图床",size:"mini"},on:{change:function(t){e.getSelectImages(e.selectValue)}},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}},e._l(e.options,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),i("el-dropdown",{staticStyle:{"margin-left":"40px"},attrs:{size:"mini",trigger:"click","split-button":"",type:"primary"}},[e._v("\n          操作\n          "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(t){return e.getCheckedImageLinks(t)}}},[i("i",{staticClass:"el-icon-circle-check"}),e._v(" 提取链接")]),e._v(" "),i("el-dropdown-item",{nativeOn:{click:function(t){return e.showInfo(t)}}},[i("i",{staticClass:"el-icon-date"}),e._v(" 查看信息")]),e._v(" "),i("el-dropdown-item",{nativeOn:{click:function(t){return e.syncToLocal(t)}}},[i("i",{staticClass:"el-icon-sort"}),e._v(" 同步到本地")]),e._v(" "),i("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(t){return e.deleteChecked(t)}}},[i("span",{staticStyle:{color:"red"}},[i("i",{staticClass:"el-icon-delete"}),e._v(" 删除选中")])])],1)],1),e._v(" "),e.showUser?i("el-switch",{staticStyle:{display:"inline","margin-left":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"操作模式","inactive-text":"查看模式","active-value":"edit","inactive-value":"view"},on:{change:e.changeModel},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}):e._e()],1)],1),e._v(" "),e.showUser?i("el-row",{staticStyle:{margin:"20px"}},[i("el-alert",{attrs:{title:"",type:"success",center:""}},[e._v("您当前正在操作的用户为 : "),i("b",[e._v(" "+e._s(e.user))]),e._v(" "),i("br"),e._v(" "),i("br"),e._v("\n        AUXPI 图床提醒您: 数据千万条,备份第一条。数据不备份,站长两行泪\n      ")])],1):e._e(),e._v(" "),i("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showProgress,expression:"showProgress"}],staticStyle:{margin:"20px"}},[i("el-col",[i("transition",{attrs:{name:"el-fade-in-linear"}},[i("el-progress",{attrs:{"stroke-width":14,percentage:e.progress,status:"success"},on:{"update:percentage":function(t){e.progress=t}}})],1)],1)],1),e._v(" "),e.isExist?i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.mainLoading,expression:"mainLoading"}],staticStyle:{margin:"20px"}},[i("el-checkbox-group",{on:{change:e.handleCheckedImageChange},model:{value:e.checkedImages,callback:function(t){e.checkedImages=t},expression:"checkedImages"}},e._l(e.imgLists,function(t,s){return i("el-col",{key:t.id,staticStyle:{padding:"0px 5px 10px"},attrs:{xs:12,sm:6,md:4,lg:4,xl:4}},[i("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[i("div",{staticClass:"image",style:{backgroundImage:"url("+t.link+")",backgroundRepeat:"no-repeat",backgroundPosition:"center top"}}),e._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("div",{staticClass:"bottom clearfix"},[i("el-row",{staticStyle:{"margin-top":"2px"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-info",plain:"",size:"mini"},on:{click:function(i){e.showSingleInfo(t)}}}),e._v(" "),i("el-button",{attrs:{type:"info",icon:"el-icon-zoom-in",plain:"",size:"mini"},on:{click:function(i){e.zoom(t.link)}}}),e._v(" "),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",plain:"",size:"mini"},on:{click:function(i){e.deleteImg(s,t.id)}}}),e._v(" "),i("el-checkbox",{key:s,staticStyle:{"margin-left":"20px"},attrs:{label:t}},[e._v(" ")])],1)],1)])])],1)}))],1):e._e(),e._v(" "),e.isExist?e._e():i("el-row",{staticStyle:{margin:"100px"}},[i("el-col",{attrs:{xs:24,sm:6,md:4,lg:4,xl:4,offset:10}},[i("el-alert",{attrs:{title:"这里什么都没有~快去补充一点图片吧 []~(￣▽￣)~*",type:"success"}})],1)],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){e.$set(e.listQuery,"page",t)},"update:limit":function(t){e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.imageInfoDialog,fullscreen:!0,title:"图片信息"},on:{"update:visible":function(t){e.imageInfoDialog=t}}},[i("el-table",{attrs:{data:e.imgInfo}},[i("el-table-column",{attrs:{property:"id",label:"ID",width:"150"}}),e._v(" "),i("el-table-column",{attrs:{property:"name",label:"名称",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"上传者"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.user.username))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"图床"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(t.row.store.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{property:"link",label:"图片链接"}}),e._v(" "),i("el-table-column",{attrs:{label:"上传时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("parseTime")(t.row.created_on,"{y}-{m}-{d} {h}:{i}"))+"\n        ")]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.imageLinkDialog,fullscreen:e.fullScreen,title:"链接合集"},on:{"update:visible":function(t){e.imageLinkDialog=t}}},[i("div",{staticStyle:{"margin-bottom":"20px"}},[i("el-button",{staticClass:"tag-read",attrs:{"data-clipboard-text":e.linksArea,size:"small"},on:{click:function(t){e.copy()}}},[e._v("\n        Copy All\n      ")])],1),e._v(" "),i("el-tabs",{staticStyle:{margin:"0px 0px 20px"},attrs:{type:"border-card"},on:{"tab-click":e.transformTo}},[i("el-tab-pane",{attrs:{label:"URL"}},[i("el-input",{attrs:{rows:e.linksRows,type:"textarea"},model:{value:e.linksArea,callback:function(t){e.linksArea=t},expression:"linksArea"}})],1),e._v(" "),i("el-tab-pane",{attrs:{label:"HTML"}},[i("el-input",{attrs:{rows:e.linksRows,type:"textarea"},model:{value:e.linksArea,callback:function(t){e.linksArea=t},expression:"linksArea"}})],1),e._v(" "),i("el-tab-pane",{attrs:{label:"MarkDown"}},[i("el-input",{attrs:{rows:e.linksRows,type:"textarea"},model:{value:e.linksArea,callback:function(t){e.linksArea=t},expression:"linksArea"}})],1),e._v(" "),i("el-tab-pane",{attrs:{label:"BBCode"}},[i("el-input",{attrs:{rows:e.linksRows,type:"textarea"},model:{value:e.linksArea,callback:function(t){e.linksArea=t},expression:"linksArea"}})],1)],1),e._v(" "),i("el-table",{attrs:{data:e.checkedImages}},[i("el-table-column",{attrs:{label:"图床"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(t.row.store.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{property:"link",label:"图片链接"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticClass:"tag-read",attrs:{"data-clipboard-text":t.row.link,size:"medium",plain:""},on:{click:e.copy}},[e._v("复制链接")])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.imageDialog,fullscreen:!0,title:"图片原图"},on:{"update:visible":function(t){e.imageDialog=t}}},[i("img",{attrs:{src:e.dialogLink}})]),e._v(" "),i("el-dialog",{attrs:{visible:e.singleInfo,title:"图片信息"},on:{"update:visible":function(t){e.singleInfo=t}}},[i("el-row",[i("el-col",[i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("img",{staticClass:"image",attrs:{src:e.info.link}}),e._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("el-button",{staticClass:"tag-read",attrs:{"data-clipboard-text":e.info.link,type:"success",size:"medium",plain:"",round:""},on:{click:e.copy}},[e._v("复制链接")]),e._v(" "),i("el-button",{attrs:{size:"medium",plain:"",round:""},on:{click:function(t){e.zoom(e.info.link)}}},[e._v("查看原图")]),e._v(" "),i("el-button",{attrs:{size:"medium",type:"warning",plain:"",round:""},on:{click:function(t){e.jump(e.info.link)}}},[e._v("新窗口查看")])],1)])],1)],1),e._v(" "),i("el-table",{staticStyle:{"margin-top":"20px"},attrs:{data:[e.info]}},[i("el-table-column",{attrs:{property:"id",label:"ID",width:"150"}}),e._v(" "),i("el-table-column",{attrs:{property:"name",label:"名称",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"上传者"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{size:"medium"}},[e._v(e._s(t.row.user.username))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"图床"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(t.row.store.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{property:"link",label:"图片链接"}}),e._v(" "),i("el-table-column",{attrs:{label:"上传时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("parseTime")(t.row.created_on,"{y}-{m}-{d} {h}:{i}"))+"\n        ")]}}])})],1)],1)],1)},[],!1,null,null,null);u.options.__file="index.vue";t.default=u.exports},Z8mc:function(e,t,i){"use strict";var s=i("6Oo8");i.n(s).a},"wk8/":function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"c",function(){return a}),i.d(t,"d",function(){return l}),i.d(t,"a",function(){return o});var s=i("t3Un");function n(e){return Object(s.a)({url:"/admin/get_users_list",method:"get",params:e})}function a(e,t){return Object(s.a)({url:"/users/"+e+"/images",method:"get",params:t})}function l(e){return Object(s.a)({url:"/users/"+e+"/info",method:"get"})}function o(e){return Object(s.a)({url:"/admin/delete_user",method:"post",data:{id:e}})}}}]);